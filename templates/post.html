{% include "header.html" %}

<!-- Page Header -->
<header class="masthead" style="background-image: url('{{ post.img_url }}')">
  <div class="container position-relative px-4 px-lg-5">
    <div class="row gx-4 gx-lg-5 justify-content-center">
      <div class="col-12 col-md-11 col-lg-9 col-xl-9">
        <div class="post-heading">
          <h1>{{ post.title }}</h1>
          <h2 class="subheading">{{ post.subtitle }}</h2>
          <span class="meta">
            Posted by
            <a href="/about#author"
               class="wf-author"
               data-author="{{ post.author.name }}">{{ post.author.name }}</a>
            on {{ post.date }}
          </span>
        </div>
      </div>
    </div>
  </div>
</header>

<!-- Post Content -->
<article>
  <div class="container px-4 px-lg-5">
    <div class="row gx-4 gx-lg-5 justify-content-center">
      <div class="col-12 col-md-11 col-lg-9 col-xl-9">
        <div class="post-body ck-content">
          {{ post.body|safe }}
        </div>

        <!-- Minimal Sources (collapsible) -->
        <div class="wf-sources my-4">
          <button
            class="wf-sources-toggle"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#sources-{{ post.id }}"
            aria-expanded="false"
            aria-controls="sources-{{ post.id }}">
            <span class="label">ðŸ”— Sources</span>
            <span class="chev" aria-hidden="true">â–¾</span>
          </button>

          <div id="sources-{{ post.id }}" class="collapse mt-2">
            {% if post.sources and post.sources|length > 0 %}
              <ul class="wf-sources-list mb-0">
                {% for s in post.sources %}
                  <li>
                    {% if s.url %}
                      <a class="wf-source-link" href="{{ s.url }}" target="_blank" rel="nofollow noopener">
                        {{ s.label }}
                      </a>
                    {% else %}
                      <span class="wf-source-plain">{{ s.label }}</span>
                    {% endif %}
                  </li>
                {% endfor %}
              </ul>
            {% else %}
              <div class="text-muted small">No sources provided for this article.</div>
            {% endif %}
          </div>
        </div>



        {% if current_user.id == 1 %}
        <div class="d-flex justify-content-end mb-4">
          <a class="btn btn-primary float-right" href="{{ url_for('edit_post', post_id=post.id) }}">Edit Post</a>
        </div>
        {% endif %}
      </div>
    </div>
  </div>
</article>

{% include "footer.html" %}
